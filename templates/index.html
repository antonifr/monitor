<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Monitoramento do Sistema</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="bg-dark text-white">
    <div class="container py-5">
        <h1 class="text-center mb-4">Monitoramento do Sistema</h1>

        <div class="row">
            <div class="col-md-4">
                <h3>CPU Temp</h3>
                <p id="cpu_temp">Carregando...</p>
            </div>
            <div class="col-md-4">
                <h3>Fan Speed</h3>
                <p id="fan_speed">Carregando...</p>
            </div>
            <div class="col-md-4">
                <h3>Disk Temp</h3>
                <p id="disk_temp">Carregando...</p>
            </div>
        </div>

        <div class="mt-4">
            <h3>Uso do Disco</h3>
            <canvas id="diskChart" width="400" height="200"></canvas>
        </div>
    </div>

    <script>
        const ctx = document.getElementById('diskChart').getContext('2d');
        const diskChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Usado %', 'Livre GB'],
                datasets: [{
                    label: 'Uso do Disco',
                    data: [0, 0],
                    backgroundColor: ['red', 'green']
                }]
            }
        });

        function fetchStats() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('cpu_temp').innerText = data.cpu_temp + " Â°C";
                    document.getElementById('fan_speed').innerText = data.fan_speed;
                    document.getElementById('disk_temp').innerText = data.disk_temp;

                    diskChart.data.datasets[0].data = [data.disk_usage.used_percent, data.disk_usage.free_gb];
                    diskChart.update();
                })
                .catch(err => console.error(err));
        }

        setInterval(fetchStats, 5000);
        fetchStats();
    </script>
</body>
</html>
